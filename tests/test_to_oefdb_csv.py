def test_to_oefdb_csv() -> None:
    from io import BytesIO

    from pandas import read_csv

    import oefdb

    oefdb_csv_fixture = "sector,category,id,name,unit,factor,uncertainty,source,year,region,date_accessed,description,source_link,lca_activity\nBuildings,Housing,housing-type_actual_rentals,Actual rentals,kg-CO2e/GBP,0.162,,BEIS,2018,GB,2021/11/10,Emission intensity of supply chain in GBP spend on: actual rentals. In actual prices in \xc2\xa3s and including VAT. Provided by BEIS/DEFRA in the official report on GHG Emissions of the UK between 1996-2018. Where source emission factors are identical across a variety of activities they have been grouped to avoid confusion - details are documented in the OEFDB data guidance.,https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/1000336/Consumtion_emissions_March_21_final_accessible_rev.ods,unknown\nBuildings,Housing,housing-type_central_heating_repairs,Central heating repairs,kg-CO2e/GBP,0.001,,BEIS,2018,GB,2021/11/10,Emission intensity of supply chain in GBP spend on: central heating repairs. In actual prices in \xc2\xa3s and including VAT. Provided by BEIS/DEFRA in the official report on GHG Emissions of the UK between 1996-2018. Where source emission factors are identical across a variety of activities they have been grouped to avoid confusion - details are documented in the OEFDB data guidance.,https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/1000336/Consumtion_emissions_March_21_final_accessible_rev.ods,unknown\nBuildings,Housing,housing-type_house_maintenance,House maintenance,kg-CO2e/GBP,0.099,,BEIS,2018,GB,2021/11/10,Emission intensity of supply chain in GBP spend on: house maintenance. In actual prices in \xc2\xa3s and including VAT. Provided by BEIS/DEFRA in the official report on GHG Emissions of the UK between 1996-2018. Where source emission factors are identical across a variety of activities they have been grouped to avoid confusion - details are documented in the OEFDB data guidance.,https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/1000336/Consumtion_emissions_March_21_final_accessible_rev.ods,unknown\nBuildings,Housing,housing-type_imputed_rent,Imputed rent,kg-CO2e/GBP,3.993,,BEIS,2018,GB,2021/11/10,Emission intensity of supply chain in GBP spend on: imputed rent. In actual prices in \xc2\xa3s and including VAT. Provided by BEIS/DEFRA in the official report on GHG Emissions of the UK between 1996-2018. Where source emission factors are identical across a variety of activities they have been grouped to avoid confusion - details are documented in the OEFDB data guidance.,https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/1000336/Consumtion_emissions_March_21_final_accessible_rev.ods,unknown\nBuildings,Housing,housing-type_water_waste_service_charges,Water/waste/service charges,kg-CO2e/GBP,0.31,,BEIS,2018,GB,2021/11/10,Emission intensity of supply chain in GBP spend on: water charges/ general waste refuse collection including skip hire/ other regular housing payments service charge for rent. In actual prices in \xc2\xa3s and including VAT. Provided by BEIS/DEFRA in the official report on GHG Emissions of the UK between 1996-2018. Where source emission factors are identical across a variety of activities they have been grouped to avoid confusion - details are documented in the OEFDB data guidance.,https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/1000336/Consumtion_emissions_March_21_final_accessible_rev.ods,unknown\nConsumer Goods and Services,Alcoholic Beverages and Tobacco,consumer_goods-type_alcoholic_drinks,Alcoholic drinks,kg-CO2e/GBP,0.08,,BEIS,2018,GB,2021/11/10,Emission intensity of supply chain in GBP spend on: spirits and liqueurs/ wine from grape or other fruit/ fortified wine/ champagne and sparkling wines/ beer and lager/ ciders and perry/ alcopops. In actual prices in \xc2\xa3s and including VAT. Provided by BEIS/DEFRA in the official report on GHG Emissions of the UK between 1996-2018. Where source emission factors are identical across a variety of activities they have been grouped to avoid confusion - details are documented in the OEFDB data guidance.,https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/1000336/Consumtion_emissions_March_21_final_accessible_rev.ods,unknown"

    oefdb_df = read_csv(BytesIO(oefdb_csv_fixture.encode("utf8")))
    oefdb_csv = oefdb.to_oefdb_csv(oefdb_df)

    assert oefdb_csv_fixture == oefdb_csv
